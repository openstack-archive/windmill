- job:
    name: windmill-buildimages
    parent: legacy-base
    run: tests/legacy/windmill-buildimages/run.yaml
    timeout: 3600
    required-projects:
      - openstack/windmill

- job:
    name: windmill-base
    run: playbooks/site.yaml
    timeout: 3600
    roles:
      - zuul: openstack/ansible-role-diskimage-builder
        name: openstack.diskimage-builder
      - zuul: openstack/ansible-role-logrotate
        name: openstack.logrotate
      - zuul: openstack/ansible-role-nodepool
        name: openstack.nodepool
      - zuul: openstack/ansible-role-shade
        name: openstack.shade
      - zuul: openstack/ansible-role-ssh
        name: openstack.ssh
      - zuul: openstack/ansible-role-sudoers
        name: openstack.sudoers
      - zuul: openstack/ansible-role-virtualenv
        name: openstack.virtualenv
      - zuul: openstack/ansible-role-zookeeper
        name: openstack.zookeeper
      - zuul: openstack/ansible-role-zuul
        name: openstack.zuul
    nodeset:
      groups:
        - name: nodepool-builder
          nodes:
            - nb01
        - name: nodepool-launcher
          nodes:
            - nl01
        - name: zookeeper
          nodes:
            - zs01
        - name: zuul-executor
          nodes:
            - ze01
        - name: zuul-merger
          nodes:
            - zm01
        - name: zuul-scheduler
          nodes:
            - zs01

- job:
    name: windmill-centos-7
    parent: windmill-base
    nodeset: centos-7

- job:
    name: windmill-fedora-26
    parent: windmill-base
    nodeset:
      nodes:
        - name: nb01
          label: fedora-26
        - name: nl01
          label: fedora-26
        - name: ze01
          label: fedora-26
        - name: zm01
          label: fedora-26
        - name: zs01
          label: fedora-26

- job:
    name: windmill-ubuntu-xenial
    parent: windmill-base
    nodeset:
      nodes:
        - name: nb01
          label: ubuntu-xenial
        - name: nl01
          label: ubuntu-xenial
        - name: ze01
          label: ubuntu-xenial
        - name: zm01
          label: ubuntu-xenial
        - name: zs01
          label: ubuntu-xenial
