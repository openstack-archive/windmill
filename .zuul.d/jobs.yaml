- job:
    name: windmill-buildimages
    parent: legacy-base
    run: tests/legacy/windmill-buildimages/run.yaml
    timeout: 3600
    required-projects:
      - openstack/windmill

- job:
    name: windmill-base
    parent: base-test
    run: playbooks/site.yaml
    timeout: 3600
    roles:
      - zuul: openstack/ansible-role-diskimage-builder
        name: openstack.diskimage-builder
      - zuul: openstack/ansible-role-logrotate
        name: openstack.logrotate
      - zuul: openstack/ansible-role-nodepool
        name: openstack.nodepool
      - zuul: openstack/ansible-role-shade
        name: openstack.shade
      - zuul: openstack/ansible-role-ssh
        name: openstack.ssh
      - zuul: openstack/ansible-role-sudoers
        name: openstack.sudoers
      - zuul: openstack/ansible-role-virtualenv
        name: openstack.virtualenv
      - zuul: openstack/ansible-role-zookeeper
        name: openstack.zookeeper
      - zuul: openstack/ansible-role-zuul
        name: openstack.zuul
    secrets:
      secret:
          - name: base_serial
            data: 1

- job:
    name: windmill-centos-7
    parent: windmill-base
    nodeset: centos-7

- job:
    name: windmill-fedora-26
    parent: windmill-base
    nodeset:
      nodes:
        - name:
            - nb01
            - nl01
            - ze01
            - zk01
            - zm01
            - zs01
          label: fedora-26

- job:
    name: windmill-ubuntu-xenial
    parent: windmill-base
    nodeset:
      nodes:
        - name:
            - nb01
            - nl01
            - ze01
            - zk01
            - zm01
            - zs01
          label: ubuntu-xenial
